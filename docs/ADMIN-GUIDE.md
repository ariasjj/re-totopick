# 관리자 매뉴얼

TOTOPICK 관리자 페이지 사용 가이드입니다.

## 🔑 관리자 로그인

### 기본 관리자 계정
- **이메일**: `admin@totopick.com`
- **비밀번호**: `admin1234`

⚠️ **보안 주의**: 첫 로그인 후 반드시 비밀번호를 변경하세요!

### 관리자 페이지 접근
로그인 후 헤더의 사용자 메뉴에서 "관리자" 클릭 또는 직접 `/admin` 페이지 접속

## 📊 대시보드

### 주요 통계
- **전체 회원**: 가입된 총 회원 수
- **전체 게시글**: 작성된 게시글 및 댓글 수
- **오늘 방문자**: 오늘 방문한 순 방문자 수
- **대기 중인 신고**: 처리가 필요한 먹튀/사기 신고
- **미답변 문의**: 답변이 필요한 1:1 문의

### 빠른 작업
- 회원 관리
- 게시글 관리
- 신고 관리
- 문의 관리

## 👥 회원 관리 (`/admin/users`)

### 회원 목록 조회
- 이메일, 닉네임으로 검색 가능
- 페이지네이션 (20명씩 표시)
- 가입일, 포인트, 활동 내역 확인

### 회원 정보 수정
```
PUT /api/admin/users/[id]
```

수정 가능 항목:
- **포인트 조정**: 포인트 증감 (이벤트, 보상 등)
- **계정 상태**: 활성화/비활성화
- **권한 변경**: USER ↔ ADMIN

### 회원 삭제
```
DELETE /api/admin/users/[id]
```

⚠️ 주의: 회원 삭제 시 해당 회원의 게시글, 댓글도 함께 삭제됩니다 (Cascade)

### 실제 사용 예시

#### 1. 포인트 지급 (이벤트)
```typescript
// 특정 회원에게 1000 포인트 지급
PUT /api/admin/users/user-id-here
{
  "points": 현재포인트 + 1000
}
```

#### 2. 계정 정지
```typescript
// 악의적인 사용자 계정 비활성화
PUT /api/admin/users/user-id-here
{
  "isActive": false
}
```

## 📝 게시글 관리

### 게시글 삭제
- 관리자는 모든 게시글 삭제 가능
- 게시글 상세 페이지에서 "삭제" 버튼

### 공지사항 설정
```typescript
// Prisma Studio 또는 직접 API 호출
UPDATE Post
SET isNotice = true
WHERE id = 'post-id'
```

공지사항으로 설정된 게시글은:
- 게시판 최상단에 고정
- "공지" 배지 표시
- 조회수/추천 정상 집계

### 게시글 숨김 처리
```typescript
UPDATE Post
SET isHidden = true
WHERE id = 'post-id'
```

## 🚨 신고 관리 (`/admin/reports`)

### 신고 처리 프로세스

1. **신고 접수** (PENDING)
   - 사용자가 먹튀/사기 신고 제출
   - 관리자 대시보드에 알림 표시

2. **검토 중** (REVIEWING)
   - 관리자가 신고 내용 확인
   - 추가 조사 진행

3. **처리 완료** (COMPLETED)
   - 신고 내용이 사실로 확인
   - 해당 사이트 블랙리스트 등록
   - 신고자에게 보상 포인트 지급 (선택)

4. **반려** (REJECTED)
   - 허위 신고 또는 증거 부족
   - 반려 사유 기록

### 신고 처리 API
```
PUT /api/admin/reports/[id]
{
  "status": "COMPLETED",
  "adminNote": "확인 완료. 해당 사이트는 먹튀 사이트로 확인되었습니다."
}
```

### 신고 처리 팁
- 신고자 연락처 확인 (필요시 추가 증거 요청)
- 동일 사이트 중복 신고 확인
- 처리 결과는 신고 게시판에 공개

## 💬 1:1 문의 관리 (`/admin/inquiries`)

### 문의 답변
```
PUT /api/admin/inquiries/[id]
{
  "answer": "답변 내용입니다. 자세한 설명..."
}
```

답변 작성 시:
- 친절하고 명확하게
- 관련 링크나 가이드 제공
- 추가 문의가 필요하면 연락처 안내

### 자주 묻는 질문

#### Q: 포인트가 적립되지 않아요
```
답변: 안녕하세요. 포인트 적립은 다음과 같이 이루어집니다:
- 출석체크: +100P
- 게시글 작성: +10P
- 댓글 작성: +5P

포인트 내역은 마이페이지에서 확인 가능합니다. 
문제가 지속되면 관리자에게 문의해주세요.
```

#### Q: 비밀번호를 잊어버렸어요
```
답변: 비밀번호는 보안상 관리자도 확인할 수 없습니다.
현재 비밀번호 찾기 기능은 개발 중이며, 
임시로 관리자가 비밀번호를 재설정해드릴 수 있습니다.
본인 확인을 위해 가입 시 사용한 전화번호를 알려주세요.
```

## 🔐 보안 및 권한

### 관리자 권한 부여
데이터베이스에서 직접 수정 (Prisma Studio 사용):

```typescript
// Prisma Studio 실행
npm run db:studio

// User 테이블에서 해당 사용자 찾기
// role을 "USER" → "ADMIN"으로 변경
```

### 보안 권장사항
1. **비밀번호 관리**
   - 강력한 비밀번호 사용 (12자 이상)
   - 정기적 변경 (3개월마다)
   - 2단계 인증 활성화 (추후 구현 예정)

2. **접근 로그 확인**
   - 비정상적인 로그인 시도 모니터링
   - IP 주소 확인

3. **백업**
   - 데이터베이스 정기 백업 (Supabase 자동 백업 활용)
   - 중요 데이터는 별도 보관

## 📊 통계 및 분석

### Prisma Studio로 데이터 확인
```bash
npm run db:studio
```

브라우저에서 http://localhost:5555 접속

### 유용한 쿼리

#### 1. 오늘 가입한 회원 수
```sql
SELECT COUNT(*) 
FROM User 
WHERE DATE(createdAt) = CURRENT_DATE;
```

#### 2. 인기 게시판 TOP 5
```sql
SELECT boardId, COUNT(*) as count
FROM Post
GROUP BY boardId
ORDER BY count DESC
LIMIT 5;
```

#### 3. 포인트 랭킹 TOP 10
```sql
SELECT nickname, points
FROM User
ORDER BY points DESC
LIMIT 10;
```

## 🛠 문제 해결

### 자주 발생하는 문제

#### 1. 관리자 페이지 접근 불가
- **원인**: 권한이 없거나 세션 만료
- **해결**: 
  1. 로그아웃 후 재로그인
  2. 데이터베이스에서 role 확인
  3. 쿠키 삭제 후 재시도

#### 2. 게시글 삭제 안됨
- **원인**: 연관된 댓글이 있는 경우
- **해결**: Cascade 삭제가 설정되어 있어 자동으로 댓글도 삭제됨. 에러 발생 시 로그 확인

#### 3. SMS 발송 실패 (프로덕션)
- **원인**: API 키 오류, 잔액 부족
- **해결**: 
  1. 환경변수 확인
  2. SMS 서비스 관리자 페이지에서 잔액 확인
  3. 로그 확인 (`docs/SMS-SETUP.md` 참고)

## 📞 긴급 대응

### 사이트 다운 시
1. Vercel 대시보드에서 배포 상태 확인
2. 데이터베이스 연결 확인 (Supabase)
3. 로그 확인 (Vercel Logs)
4. 필요시 이전 버전으로 롤백

### 대량 스팸 발생 시
1. IP 차단 (Vercel Firewall)
2. 해당 계정 즉시 정지
3. 스팸 게시글 일괄 삭제
4. Rate Limiting 강화

### 개인정보 유출 의심 시
1. 즉시 서비스 중단
2. 데이터베이스 백업
3. 로그 분석
4. 보안 전문가 자문

## 📈 성장 전략

### 커뮤니티 활성화
- 정기 이벤트 (출석 이벤트, 베스트 글 선정)
- 포인트 보상 시스템 활용
- 우수 회원 배지 시스템 (추후 구현)

### 콘텐츠 관리
- 양질의 분석글 작성 장려
- 스팸/저품질 콘텐츠 적극 제거
- 공지사항 정기 업데이트

## 🔄 정기 작업

### 일일 작업
- [ ] 대기 중인 신고 확인 및 처리
- [ ] 미답변 문의 답변
- [ ] 스팸 게시글 확인 및 삭제

### 주간 작업
- [ ] 통계 리뷰 (회원 증가율, 활성 사용자)
- [ ] 인기 게시글 선정
- [ ] 데이터베이스 성능 확인

### 월간 작업
- [ ] 전체 백업
- [ ] 보안 업데이트 적용
- [ ] 사용자 피드백 수집 및 반영

---

**문의**: 관리자 관련 문제는 개발자에게 직접 문의하세요.


